<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pulmonary Embolism Risk Scores (Wells & Geneva)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/genralPages.css">
  <script src="https://kit.fontawesome.com/834304401a.js" crossorigin="anonymous"></script>
  <script src="/script.js"></script>
  <style>
    body {
      font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      font-size: 16px;
      font-weight: bold;
      line-height: 1.8;
      color: #333;
      background-image: url("/images/resp.svg"); /* adjust if needed */
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
    }

    main {
      padding: 0 1rem 2rem;
      background-color: rgba(255, 255, 255, 0.92);
    }

    h1.page-title {
      background-color: #0066cc;
      color: #ffffff;
      padding: 15px 20px;
      margin: 0 0 15px;
      font-size: 1.6rem;
    }

    h2 {
      color: #0066cc;
      margin-top: 1.5rem;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 10px;
      margin-bottom: 15px;
    }

    th, td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #ddd;
      vertical-align: top;
    }

    th {
      background-color: #f2f6ff;
      color: #003366;
    }

    input[type="checkbox"] {
      transform: scale(1.1);
      margin-right: 8px;
    }

    ul, ol {
      margin-top: 10px;
      margin-bottom: 10px;
      padding-left: 20px;
    }

    li {
      margin-bottom: 5px;
    }

    .score-box {
      background-color: #f8fbff;
      border-left: 4px solid #0066cc;
      padding: 10px 12px;
      margin: 10px 0 15px;
      border-radius: 4px;
      font-size: 0.95rem;
    }

    .danger-box {
      background-color: #fff5f5;
      border-left: 4px solid #cc0000;
      padding: 10px 12px;
      margin: 10px 0 15px;
      border-radius: 4px;
      font-size: 0.95rem;
    }

    .btn {
      display: inline-block;
      margin-top: 10px;
      padding: 8px 14px;
      border-radius: 4px;
      border: none;
      background-color: #0066cc;
      color: #fff;
      font-size: 0.95rem;
      cursor: pointer;
    }

    .btn:hover {
      background-color: #004c99;
    }

    @media (max-width: 768px) {
      main {
        padding: 0 0.5rem 2rem;
      }

      h1.page-title {
        font-size: 1.3rem;
        padding: 10px 12px;
      }
    }
  </style>
</head>

<body>
  <header>
    <div class="logo-container">
      <h1>Pulmonary Embolism Risk Scores</h1>
      <a href="/index.html" title="Home"><i class="fa-solid fa-house"></i></a>
      <button class="back-button" onclick="goBack()">Back</button>
    </div>
  </header>

  <main>
    <h1 class="page-title">Wells & Geneva Scores for Suspected Pulmonary Embolism</h1>

    <div class="score-box">
      <strong>Important:</strong> This page is designed for teaching and bedside support only.
      Always use your clinical judgement and follow your local / national PE protocols.
      Discuss uncertain or high-risk cases with a senior.
    </div>

    <!-- WELLS SCORE FOR PE -->
    <section>
      <h2>1. Wells Score for Pulmonary Embolism</h2>
      <p>The Wells score helps stratify the pre-test probability of PE.</p>

      <table>
        <thead>
          <tr>
            <th>Include?</th>
            <th>Criterion</th>
            <th>Points</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><input type="checkbox" class="wells-pe-item" data-points="3"></td>
            <td>Clinical signs and symptoms of DVT (minimum of leg swelling and pain with palpation of deep veins)</td>
            <td>+3.0</td>
          </tr>
          <tr>
            <td><input type="checkbox" class="wells-pe-item" data-points="3"></td>
            <td>PE is the most likely diagnosis (more likely than alternative diagnoses)</td>
            <td>+3.0</td>
          </tr>
          <tr>
            <td><input type="checkbox" class="wells-pe-item" data-points="1.5"></td>
            <td>Heart rate &gt; 100 beats per minute</td>
            <td>+1.5</td>
          </tr>
          <tr>
            <td><input type="checkbox" class="wells-pe-item" data-points="1.5"></td>
            <td>Immobilisation for ≥3 days or surgery in the previous 4 weeks</td>
            <td>+1.5</td>
          </tr>
          <tr>
            <td><input type="checkbox" class="wells-pe-item" data-points="1.5"></td>
            <td>Previous DVT or PE</td>
            <td>+1.5</td>
          </tr>
          <tr>
            <td><input type="checkbox" class="wells-pe-item" data-points="1"></td>
            <td>Haemoptysis</td>
            <td>+1.0</td>
          </tr>
          <tr>
            <td><input type="checkbox" class="wells-pe-item" data-points="1"></td>
            <td>Malignancy (on treatment, treated in the last 6 months, or palliative)</td>
            <td>+1.0</td>
          </tr>
        </tbody>
      </table>

      <button class="btn" type="button" onclick="calculateWellsPE()">Calculate Wells PE Score</button>

      <div id="wells-pe-result" class="score-box" style="display:none;"></div>

      <h3>Wells PE Interpretation</h3>
      <ul>
        <li><strong>Traditional bands:</strong>
          <ul>
            <li>Low: &lt; 2</li>
            <li>Moderate: 2–6</li>
            <li>High: &gt; 6</li>
          </ul>
        </li>
        <li><strong>Simplified:</strong>  
          <ul>
            <li>PE unlikely: ≤ 4</li>
            <li>PE likely: &gt; 4</li>
          </ul>
        </li>
      </ul>
    </section>

    <!-- GENEVA SCORE -->
    <section>
      <h2>2. Revised Geneva Score</h2>
      <p>The revised Geneva score is an alternative, fully objective PE risk score (no “PE most likely” item).</p>

      <table>
        <thead>
          <tr>
            <th>Include?</th>
            <th>Criterion</th>
            <th>Points</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><input type="checkbox" class="geneva-item" data-points="1"></td>
            <td>Age &gt; 65 years</td>
            <td>+1</td>
          </tr>
          <tr>
            <td><input type="checkbox" class="geneva-item" data-points="3"></td>
            <td>Previous DVT or PE</td>
            <td>+3</td>
          </tr>
          <tr>
            <td><input type="checkbox" class="geneva-item" data-points="2"></td>
            <td>Surgery or fracture within 1 month</td>
            <td>+2</td>
          </tr>
          <tr>
            <td><input type="checkbox" class="geneva-item" data-points="2"></td>
            <td>Active malignancy</td>
            <td>+2</td>
          </tr>
          <tr>
            <td><input type="checkbox" class="geneva-item" data-points="3"></td>
            <td>Unilateral lower limb pain</td>
            <td>+3</td>
          </tr>
          <tr>
            <td><input type="checkbox" class="geneva-item" data-points="2"></td>
            <td>Haemoptysis</td>
            <td>+2</td>
          </tr>
          <tr>
            <td><input type="checkbox" class="geneva-item" data-points="3"></td>
            <td>Heart rate 75–94 bpm</td>
            <td>+3</td>
          </tr>
          <tr>
            <td><input type="checkbox" class="geneva-item" data-points="5"></td>
            <td>Heart rate ≥ 95 bpm</td>
            <td>+5</td>
          </tr>
          <tr>
            <td><input type="checkbox" class="geneva-item" data-points="4"></td>
            <td>Pain on deep venous palpation of lower limb and unilateral oedema</td>
            <td>+4</td>
          </tr>
        </tbody>
      </table>

      <button class="btn" type="button" onclick="calculateGeneva()">Calculate Geneva Score</button>

      <div id="geneva-result" class="score-box" style="display:none;"></div>

      <h3>Geneva Interpretation</h3>
      <ul>
        <li><strong>0–3:</strong> Low probability</li>
        <li><strong>4–10:</strong> Intermediate probability</li>
        <li><strong>≥ 11:</strong> High probability</li>
      </ul>
    </section>

    <!-- ED APPROACH SUMMARY -->
    <section>
      <h2>3. Suggested ED Approach (Framework)</h2>
      <ol>
        <li>
          <strong>Stratify pre-test probability</strong> using Wells or Geneva (or both) together with your clinical judgement.
        </li>
        <li>
          <strong>Low pre-test probability + normal vitals:</strong>
          <ul>
            <li>Consider D-dimer (age-adjusted cut-off if used in your setting).</li>
            <li>Negative D-dimer → PE very unlikely; look for alternative diagnoses.</li>
            <li>Positive D-dimer → arrange CTPA or V/Q scan (as per local policy and availability).</li>
          </ul>
        </li>
        <li>
          <strong>Intermediate / High pre-test probability:</strong>
          <ul>
            <li>Arrange urgent CTPA (or V/Q scan if CTPA contraindicated/unavailable).</li>
            <li>Consider empiric anticoagulation if PE is strongly suspected and bleeding risk acceptable, especially if there will be a delay to imaging (follow local protocols).</li>
          </ul>
        </li>
        <li>
          <strong>If PE confirmed:</strong>
          <ul>
            <li>Risk stratify (e.g. shock/hypotension, RV strain, troponin, PESI/sPESI if used locally).</li>
            <li>Start appropriate anticoagulation (LMWH, DOAC, or warfarin-based regimens as per protocol).</li>
            <li>Discuss massive or high-risk PE (hypotension/shock) urgently with seniors and consider thrombolysis or advanced therapies where indicated.</li>
          </ul>
        </li>
        <li>
          <strong>Always assess:</strong> pregnancy, renal function, active bleeding, recent surgery, and drug interactions before selecting an anticoagulant.
        </li>
      </ol>

      <div class="danger-box">
        <strong>Red flags – treat as an emergency and escalate immediately:</strong>
        <ul>
          <li>Shock or persistent hypotension</li>
          <li>Severe hypoxia out of proportion to CXR</li>
          <li>Syncope or pre-syncope with suspected PE</li>
          <li>Signs of right heart strain (ECG, bedside echo where available)</li>
        </ul>
      </div>
    </section>
  </main>

  <script>
    function calculateWellsPE() {
      const items = document.querySelectorAll('.wells-pe-item');
      let score = 0;

      items.forEach(item => {
        if (item.checked) {
          const pts = parseFloat(item.getAttribute('data-points')) || 0;
          score += pts;
        }
      });

      let band = '';
      let simplified = '';
      let summary = '';

      if (score < 2) {
        band = 'Low probability (traditional band)';
      } else if (score >= 2 && score <= 6) {
        band = 'Moderate probability (traditional band)';
      } else {
        band = 'High probability (traditional band)';
      }

      if (score <= 4) {
        simplified = 'PE unlikely (simplified interpretation).';
        summary = 'Consider D-dimer if appropriate. If D-dimer negative and no red flags, PE is unlikely.';
      } else {
        simplified = 'PE likely (simplified interpretation).';
        summary = 'Arrange urgent imaging (CTPA/VQ) and consider empiric anticoagulation if not contraindicated.';
      }

      const resultDiv = document.getElementById('wells-pe-result');
      resultDiv.style.display = 'block';
      resultDiv.innerHTML = `
        <strong>Total Wells PE score:</strong> ${score.toFixed(1)}<br>
        <strong>Traditional band:</strong> ${band}<br>
        <strong>Simplified:</strong> ${simplified}<br>
        <span style="font-size:0.9rem;">${summary}</span>
      `;
    }

    function calculateGeneva() {
      const items = document.querySelectorAll('.geneva-item');
      let score = 0;

      items.forEach(item => {
        if (item.checked) {
          const pts = parseFloat(item.getAttribute('data-points')) || 0;
          score += pts;
        }
      });

      let category = '';
      let summary = '';

      if (score <= 3) {
        category = 'Low probability';
        summary = 'Consider D-dimer if appropriate. If negative and the patient is stable with no red flags, PE is unlikely.';
      } else if (score >= 4 && score <= 10) {
        category = 'Intermediate probability';
        summary = 'Arrange imaging (CTPA/VQ) and consider empiric anticoagulation depending on bleeding risk and delay to imaging.';
      } else {
        category = 'High probability';
        summary = 'PE is likely. Arrange urgent imaging and consider immediate anticoagulation if not contraindicated.';
      }

      const resultDiv = document.getElementById('geneva-result');
      resultDiv.style.display = 'block';
      resultDiv.innerHTML = `
        <strong>Total Geneva score:</strong> ${score}<br>
        <strong>Risk category:</strong> ${category}<br>
        <span style="font-size:0.9rem;">${summary}</span>
      `;
    }
  </script>
</body>
</html>
